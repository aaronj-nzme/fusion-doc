

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Isomorphic vs. Server vs. SPA rendering &mdash; Fusion-Doc 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Messaging Between Components" href="messga-between-components.html" />
    <link rel="prev" title="Working with Display Properties" href="display-properties.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Fusion-Doc
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Components:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="output.html">Creating and Using Output Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature.html">Creating a Feature Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="layout.html">Creating a Layout Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="chain.html">Creating a Chain Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="event-handling.html">Event Handling and Interaction</a></li>
</ul>
<p class="caption"><span class="caption-text">Data:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="content-source.html">Defining a Content Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment.html">Using Environment Variables and “Secrets”</a></li>
<li class="toctree-l1"><a class="reference internal" href="consumer-hoc.html">Using the Consumer Higher-Order Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetching-content.html">Fetching Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuring-content.html">Dynamically Configuring Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="content-filtering.html">Content Filtering in Fusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="site-properties.html">Using Site Properties</a></li>
</ul>
<p class="caption"><span class="caption-text">General:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Folder.html">Examining the Feature Pack</a></li>
<li class="toctree-l1"><a class="reference internal" href="style.html">Adding Styling to Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom-fields.html">Adding Custom Fields to Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="display-properties.html">Working with Display Properties</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Isomorphic vs. Server vs. SPA rendering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rendering-isomorphically-universally">Rendering isomorphically/universally</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rendering-server-side-only">Rendering server-side only</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rendering-client-side-only">Rendering client-side only</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="messga-between-components.html">Messaging Between Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom-error-page.html">Using Custom Error Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="return-non-html-content-type.html">Creating a Web API Returning a Non-HTML Content Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="service-work.html">Using Service Workers with Fusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="local-webpack-states-file.html">Locally Generated Webpack Stats File</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-features-outside-of-fusion.html">Including Static Features Outside of Fusion</a></li>
</ul>
<p class="caption"><span class="caption-text">Best Practices:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bp.html">Best Practices</a></li>
</ul>
<p class="caption"><span class="caption-text">Hooks:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hooks-configuring-content.html">Dynamically Configuring Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks-fetching-content.html">Fetching Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks-event-handling.html">Event Handling and Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">React Hooks</a></li>
</ul>
<p class="caption"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api-output.html">Output Type API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-feature.html">Feature API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-layout.html">Layout API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-chain.html">Chain API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-custom-fields.html">Custom Fields API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-consumer.html">Consumer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-context.html">Context Component API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-content.html">Content Component API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-static.html">Static Component API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-content-source.html">Content Source API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-plugins.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-local-development-mock.html">Local Mocks API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-site-properties.html">Site Properties API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-fusion-http.html">Fusion HTTP API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Fusion-Doc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Isomorphic vs. Server vs. SPA rendering</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/isomorphic-server-spa.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="isomorphic-vs-server-vs-spa-rendering">
<h1>Isomorphic vs. Server vs. SPA rendering<a class="headerlink" href="#isomorphic-vs-server-vs-spa-rendering" title="Permalink to this headline">¶</a></h1>
<p>One of the enormous benefits of writing Fusion Feature Packs as React components is the ability to render them <a class="reference external" href="https://en.wikipedia.org/wiki/Isomorphic_JavaScript">“isomorphically”</a> - meaning on both the server-side and again on the client-side. However, isomorphic rendering isn’t the only option when writing Features - Fusion gives you the flexibility to choose what context you want each of your Features to render in.</p>
<p>For Fusion’s purposes, Output Types will always be rendered server-side only, since they are the HTML shell of the page itself. Layouts and Chains will always be rendered isomorphically, since they may contain multiple Features - some that are server-side only, and some client-side only. Features, however, can be configured to render isomorphically, server-side only, or client-side only. Let’s talk about why you’d want to use each rendering option, and how to do so.</p>
<div class="section" id="rendering-isomorphically-universally">
<h2>Rendering isomorphically/universally<a class="headerlink" href="#rendering-isomorphically-universally" title="Permalink to this headline">¶</a></h2>
<p>Isomorphic rendering offers lots of benefits when building a modern <a class="reference external" href="https://en.wikipedia.org/wiki/Single-page_application">Single Page Application</a> - you get the rich interactivity and performance benefits of running a client-side web application, without losing SEO-optimization or the ability to render in non-JavaScript-enabled clients.</p>
<p>If a Feature you’re building has some sort of client-side interaction (<code class="docutils literal notranslate"><span class="pre">onClick</span></code>, <code class="docutils literal notranslate"><span class="pre">onSubmit</span></code>, <code class="docutils literal notranslate"><span class="pre">keyPress</span></code> events, etc.), but you also need to render it server-side, you’ll want to render isomorphically.</p>
<p>The good news is isomorphic rendering is the default in Fusion - if you’d like to render a Feature isomorphically, simply write your components normally and they’ll render in both contexts.</p>
</div>
<div class="section" id="rendering-server-side-only">
<h2>Rendering server-side only<a class="headerlink" href="#rendering-server-side-only" title="Permalink to this headline">¶</a></h2>
<p>Sometimes, isomorphic rendering won’t be appropriate for a certain component. Perhaps you’re writing a component that uses some code that shouldn’t be exposed to the client, or maybe you just don’t want to send the extra bytes of JavaScript to the browser for this component since it never gets updated client-side. For these situations, you may want to render server-side only.</p>
<p>If you’d like to mark a Feature to be rendered on the server only, you can add a <code class="docutils literal notranslate"><span class="pre">.static</span> <span class="pre">=</span> <span class="pre">true</span></code> property to it like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span>  <span class="o">/</span><span class="n">components</span><span class="o">/</span><span class="n">features</span><span class="o">/</span><span class="n">movies</span><span class="o">/</span><span class="n">movie</span><span class="o">-</span><span class="n">detail</span><span class="o">.</span><span class="n">jsx</span>  <span class="o">*/</span>

<span class="kn">import</span> <span class="nn">React</span><span class="o">,</span> <span class="p">{</span> <span class="n">Component</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;react&#39;</span>

<span class="k">class</span> <span class="nc">MovieDetail</span> <span class="n">extends</span> <span class="n">Component</span> <span class="p">{</span>
  <span class="o">...</span>
<span class="p">}</span>

<span class="n">MovieDetail</span><span class="o">.</span><span class="n">static</span> <span class="o">=</span> <span class="n">true</span>

<span class="n">export</span> <span class="n">default</span> <span class="n">MovieDetail</span>
</pre></div>
</div>
<p>This will tell Fusion that this component should be rendered into HTML on the server-side, but then <strong>not</strong> re-hydrated as a React component client-side.</p>
<p><strong>WARNING</strong></p>
<p>There are downsides to rendering server-side only. Firstly, your component will be wrapped in a containing <code class="docutils literal notranslate"><span class="pre">div</span></code> that tells Fusion not to reload it client-side - this could affect your styling. Another downside is that your content may become stale if it changes before Fusion’s CDN has expired it.</p>
<p>Good candidates for static components meet the following criteria:</p>
<ul class="simple">
<li>They have no client-side interactivity implemented by React or Fusion</li>
<li>They don’t use any content from a content source at all, OR they use <strong>only</strong> <code class="docutils literal notranslate"><span class="pre">globalContent</span></code>, not feature-level content, as it’s easier to purge caches for <code class="docutils literal notranslate"><span class="pre">globalContent</span></code> and therefore less likely to serve stale content</li>
</ul>
</div>
<div class="section" id="rendering-client-side-only">
<h2>Rendering client-side only<a class="headerlink" href="#rendering-client-side-only" title="Permalink to this headline">¶</a></h2>
<p>The final option available to us is rendering client-side only. This is a bit of a misnomer with Fusion, as your React component’s <code class="docutils literal notranslate"><span class="pre">render</span></code> function will get invoked on the server no matter what. However, you can choose to render empty markup (without content) on the server, and then fill in the component with content on the client-side later. This may offer a small performance benefit, as you’ll avoid fetching content for this component server-side. This option is best for Features that are not crucial to the content of the page and can be loaded with a small delay.</p>
<p>In Fusion, there are two ways to ensure that code <strong>only</strong> gets run on the client side: use a conditional to check for the <code class="docutils literal notranslate"><span class="pre">window</span></code> object (which is only available on the client), or to put client-side code inside the <code class="docutils literal notranslate"><span class="pre">componentDidMount</span></code> React lifecycle method. This method will get triggered once your component gets mounted on the page client-side, but does not get executed server-side.</p>
<p>Let’s see how that might look in our <code class="docutils literal notranslate"><span class="pre">MovieList</span></code> component:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/*  /components/features/movies/movie-list/default.jsx  */
import Consumer from &#39;fusion:consumer&#39;
import React, { Fragment, Component } from &#39;react&#39;
import &#39;./style.scss&#39;

@Consumer
class MovieList extends Component {
  constructor (props) {
    super(props)
    this.state = { movies: [], page: 1 }
  }

  componentDidMount() {
    // We moved our `this.fetch()` call to `componentDidMount` from `constructor`
    this.fetch()
  }

  fetch () {
    ... // All our fetching logic from earlier is still here
  }

  render () {
    // If the window object doesn&#39;t exist, we will return an empty Fragment
    if (typeof window === &#39;undefined&#39;) return null

    ... // All our rendering logic for the rest of the component is still here
  }
}

MovieList.propTypes = {
  customFields: PropTypes.shape({
    movieListConfig: PropTypes.contentConfig(&#39;movies&#39;)
  })
}

export default MovieList
</pre></div>
</div>
<p>We’ve done two things to ensure our component doesn’t fetch or render server side:</p>
<ul class="simple">
<li>We moved our content fetch call inside of <code class="docutils literal notranslate"><span class="pre">componentDidMount</span></code>, so now it will only occur client-side</li>
<li>Additionally, we added a check in the <code class="docutils literal notranslate"><span class="pre">render</span></code> method to render an empty <code class="docutils literal notranslate"><span class="pre">Fragment</span></code> if the <code class="docutils literal notranslate"><span class="pre">window</span></code> object doesn’t exist, which will only be true on the server.</li>
</ul>
<p>The effect of both these changes is that the HTML rendered from our component on the server will be empty initially, and content will only be fetched and fill the component on the client-side!</p>
<p><strong>WARNING</strong></p>
<p>Rendering client-side only could affect SEO adversely, since web crawlers typically have difficulty reading AJAX-only web pages - although <a class="reference external" href="https://developers.google.com/search/docs/ajax-crawling/docs/learn-more">they have been improving</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="messga-between-components.html" class="btn btn-neutral float-right" title="Messaging Between Components" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="display-properties.html" class="btn btn-neutral float-left" title="Working with Display Properties" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Guess Me

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>